# 1. 常见的package.json的配置

-   npm 官方文档文档地址： https://docs.npmjs.com/cli/v10/configuring-npm/package-json
-   Node.js 官方文档 (模块解析机制)：https://nodejs.org/api/packages.html
-   3 种产物指定入口配置：

```js
{
  "name": "my-ui-library",
  "version": "1.0.0",
  // 1. 类型定义入口 (必须指向 .d.ts)
  "types": "./dist/index.d.ts",

  // 2. CJS 入口 (兼容老旧环境)：https://docs.npmjs.com/cli/v10/configuring-npm/package-json#main
  "main": "./dist/index.cjs",

  // 3. ESM 入口 (兼容不支持 exports 的打包工具)
  "module": "./dist/index.js",

  // 4. IIFE 入口 (给 CDN 用)
  "unpkg": "./dist/index.iife.js",
  "jsdelivr": "./dist/index.iife.js",

  // 5. 现代入口配置 (最高优先级:一般不配置
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",  // TS 类型
      "import": "./dist/index.js",   // 遇到 import 语句，用 ESM
      "require": "./dist/index.cjs"  // 遇到 require 语句，用 CJS
    },
    // 如果你允许用户引入 CSS
    "./style.css": "./dist/style.css"
  },

  // 指定发布到 npm 的文件白名单
  "files": [
    "dist"
  ]
}

```

# 2. 使用@lcllcllcl/ui

1. 方法1：

-   使用workspace创建软连接，连接@miaoma/ui：可以在node_modules中查看

```js
import { Button } from '@lcllcllcl/ui'
```

默认会去node_modules/@lcllcllcl/ui/package.json中寻找入口文件（main、module、type），然后根据入口文件设置的路径去寻找资源

> 场景一：用户在 Vite/Next.js 项目中开发 (ESM)
> 代码： import { Button } from 'my-ui-library';
> 流程：
> Vite 读取 package.json。
> 发现 exports 字段。
> 匹配 import 条件。
> 结果： 加载 ./dist/index.js (ESM)。
> 收益： 成功 Tree-shaking，只打包了 Button 的代码。

-   打包@miaoma/ui，产生需要的静态资源

2. 进阶解决方法2：适用于开发环境：

-   使用workspace创建软连接，连接@miaoma/ui：可以在node_modules中查看
-   将包名直接映射到@miaoma/ui源码入口：[vite.config.ts](vite.config.ts)

```js
'@lcllcllcl/ui': path.resolve(__dirname, '../../packages/ui/src/index.ts')
```

> 这样做的收益：
>
> -   无需构建： 开发时直接消费 TS 源码。
> -   实时调试： console.log 或断点直接打在源码里，而不是压缩后的代码里。

-   打包工具搞定，下面配置TS 编译器，TS 编译器默认不会像 Vite 那样去读 Alias，所以会找不到路劲：配置paths、与include：[tsconfig.app.json](tsconfig.app.json)

# 3. tsup rollup、vite常见的打包配置(后面了解 )

> 遇到了在查看文档问ai

-   tsup: https://tsup.egoist.dev/#multiple-entrypoints
    [tsconfig.json](packages/ui/tsconfig.json)

# 状态管理

-   笔记：https://my.feishu.cn/docx/CEQcd7dgyoMwhjxD9Y6cC3RDn9a
-   Mantine UI 内部自实现的集中状态管理：（学习）https://github.com/mantinedev/mantine/blob/master/packages/%40mantine/store/src/store.ts
-   官网useSyncExternalStore：https://zh-hans.react.dev/reference/react/useSyncExternalStore

    -   代码：[code](apps/use-ui/src/01.learn-useSyncExternalStore)

# 初步认识vitest: [text](packages/ui/vitest.md)

# 其它

<!-- -----------asdasdasd------ -->

-   Npm 私服搭建：https://verdaccio.org/zh-cn/
-   nrm：https://github.com/Pana/nrm
